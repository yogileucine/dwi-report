{"uid":"6db3953bc8922451","name":"Verify audit logs for parameters linked with CJF resource parameter","fullName":"tests.scenarios.job_audits.test_audit_logs_of_linked_parameters.TestAuditLogsOfLinkedParameters#test_job_audit_for_linked_parameters_with_cjf_resource_parameter","historyId":"07dce58e4f78d0e9c25aa5a2da846b43","time":{"start":1733504954782,"stop":1733504974375,"duration":19593},"description":"This test case tests audits logs for parameters linked with CJF resource parameter during execution","descriptionHtml":"<p>This test case tests audits logs for parameters linked with CJF resource parameter during execution</p>\n","status":"failed","statusMessage":"AssertionError: Audit logs for parameters linked with cjf resource parameter are not as expected. Expected: ['Malini L (ID:L-process.publisher.03) completed the Job', 'Malini L (ID:L-process.publisher.03) completed the task \"Task-1.1\" as Task1.1 of the stage \"Stage-1\"', 'Malini L (ID:L-process.publisher.03) created the Job', 'Malini L (ID:L-process.publisher.03) started the Job', 'Malini L (ID:L-process.publisher.03) started the task \"Task-1.1\" as Task1.1 of the stage \"Stage-1\"', 'System (ID:SYSTEM) Assigned User Group(s) to Task(s) in the Job', 'System (ID:SYSTEM) Assigned User(s) to Task(s) in the Job', 'System (ID:SYSTEM) Unassigned User Group(s) from Task(s) in the Job', 'System (ID:SYSTEM) provided a value of \"123\" for \"number-1\" in Task1.1 \"Task-1.1\" of the stage \"Stage-1\"', 'System (ID:SYSTEM) set \"Dec 01, 2023 13:23\" for \"date_time-1\" in Task1.1 \"Task-1.1\" of the stage \"Stage-1\"', 'System (ID:SYSTEM) set \"Dec 12, 2012\" for \"date-1\" in Task1.1 \"Task-1.1\" of the stage \"Stage-1\"', 'System (ID:SYSTEM) updated text input to \"multi_line\" for parameter \"multi_line_text-1\" in Task1.1 \"Task-1.1\" of the stage \"Stage-1\"', 'System (ID:SYSTEM) updated text input to \"single_line\" for parameter \"single_line_text-1\" in Task1.1 \"Task-1.1\" of the stage \"Stage-1\"'] Actual: ['Malini L (ID:L-process.publisher.03) completed the Job', 'Malini L (ID:L-process.publisher.03) completed the task \"Task-1.1\" as Task1.1 of the stage \"Stage-1\"', 'Malini L (ID:L-process.publisher.03) created the Job', 'Malini L (ID:L-process.publisher.03) selected \"Auto-test-object(ID: Auto_single_line_value_933817)\" for parameter \"single_resource-1\" for Create Job Form (CFJ) Parameter', 'Malini L (ID:L-process.publisher.03) started the Job', 'Malini L (ID:L-process.publisher.03) started the task \"Task-1.1\" as Task1.1 of the stage \"Stage-1\"', 'System (ID:SYSTEM) Assigned User Group(s) to Task(s) in the Job', 'System (ID:SYSTEM) Assigned User(s) to Task(s) in the Job', 'System (ID:SYSTEM) Unassigned User Group(s) from Task(s) in the Job', 'System (ID:SYSTEM) provided a value of \"123\" for \"number-1\" in Task1.1 \"Task-1.1\" of the stage \"Stage-1\"', 'System (ID:SYSTEM) set \"{{{0}}}\" for \"date-1\" in Task1.1 \"Task-1.1\" of the stage \"Stage-1\"', 'System (ID:SYSTEM) set \"{{{0}}}\" for \"date_time-1\" in Task1.1 \"Task-1.1\" of the stage \"Stage-1\"', 'System (ID:SYSTEM) updated text input to \"multi_line\" for parameter \"multi_line_text-1\" in Task1.1 \"Task-1.1\" of the stage \"Stage-1\"', 'System (ID:SYSTEM) updated text input to \"single_line\" for parameter \"single_line_text-1\" in Task1.1 \"Task-1.1\" of the stage \"Stage-1\"']","statusTrace":"self = <test_audit_logs_of_linked_parameters.TestAuditLogsOfLinkedParameters object at 0x7af822000950>, user_group_creation = 'Auto_Test_user_group585', job_execution_by = 'user_group', users_list = []\n\n    @allure.title(\"Verify audit logs for parameters linked with CJF resource parameter\")\n    @allure.description(\n        \"This test case tests audits logs for parameters linked with CJF resource parameter during execution\")\n    @allure.link(\"https://app.clickup.com/t/86cuvfapc\")\n    @pytest.mark.scenario\n    @pytest.mark.job\n    @pytest.mark.job_audits\n    @pytest.mark.job_audits_for_linked_parameters_with_cjf_resource_parameter\n    @pytest.mark.parametrize(\"job_execution_by, users_list\", [(\"user\", [Env.get_env_data(\"QA_PUBLISHER_USERNAME_01\")]),\n                                                              (\"user_group\", [])])\n    def test_job_audit_for_linked_parameters_with_cjf_resource_parameter(self, user_group_creation, job_execution_by,\n                                                                         users_list):\n        self.executed_job.test_values_of_linked_parameters_after_executing_resource_parameter_mapped_to_cjf(\n            user_group_creation, job_execution_by, users_list)\n        complete_job_log = const.AUDIT_LOGS.pop()\n        complete_task_log = const.AUDIT_LOGS.pop()\n        const.AUDIT_LOGS.append(\n            \"System (ID:SYSTEM) updated text input to \\\"single_line\\\" for parameter \\\"single_line_text-1\\\" in Task1.1 \\\"Task-1.1\\\" of the stage \\\"Stage-1\\\"\")\n        const.AUDIT_LOGS.append(\n            \"System (ID:SYSTEM) updated text input to \\\"multi_line\\\" for parameter \\\"multi_line_text-1\\\" in Task1.1 \\\"Task-1.1\\\" of the stage \\\"Stage-1\\\"\")\n        const.AUDIT_LOGS.append(\n            \"System (ID:SYSTEM) set \\\"Dec 12, 2012\\\" for \\\"date-1\\\" in Task1.1 \\\"Task-1.1\\\" of the stage \\\"Stage-1\\\"\")\n        const.AUDIT_LOGS.append(\n            \"System (ID:SYSTEM) provided a value of \\\"123\\\" for \\\"number-1\\\" in Task1.1 \\\"Task-1.1\\\" of the stage \\\"Stage-1\\\"\")\n        const.AUDIT_LOGS.append(\n            \"System (ID:SYSTEM) set \\\"Dec 01, 2023 13:23\\\" for \\\"date_time-1\\\" in Task1.1 \\\"Task-1.1\\\" of the stage \\\"Stage-1\\\"\")\n        const.AUDIT_LOGS.append(complete_task_log)\n        const.AUDIT_LOGS.append(complete_job_log)\n    \n        if job_execution_by == \"user_group\":\n            const.AUDIT_LOGS.append(\"System  (ID:SYSTEM) Assigned User(s) to Task(s) in the Job\")\n            const.AUDIT_LOGS.append(\"System  (ID:SYSTEM) Assigned User Group(s) to Task(s) in the Job\")\n            const.AUDIT_LOGS.append(\"System  (ID:SYSTEM) Unassigned User Group(s) from Task(s) in the Job\")\n    \n        audit_logs_details = self.job_obj.fetch_job_audits_logs()[0]\n        value = audit_logs_details[2][\"parameters\"][\"0\"][\"value\"]\n        date_time = (datetime.fromtimestamp(value)).strftime(\"%b %d, %Y %H:%M\")\n        value = audit_logs_details[4][\"parameters\"][\"0\"][\"value\"]\n        date = (datetime.fromtimestamp(value)).strftime(\"%b %d, %Y\")\n    \n        audit_logs = self.job_obj.fetch_job_audits_logs()[1]\n        if job_execution_by == \"user\":\n            audit_logs[5] = audit_logs[5].format(date).replace(\"{\", \"\").replace(\"}\", \"\")\n            audit_logs[7] = audit_logs[7].format(date_time).replace(\"{\", \"\").replace(\"}\", \"\")\n            audit_logs = list(map(lambda log: \" \".join(log.split()), audit_logs))\n            if audit_logs != const.AUDIT_LOGS:\n                raise AssertionError(\n                    f\"Audit logs for parameters linked with cjf resource parameter are not as expected. \"\n                    f\"Expected: {const.AUDIT_LOGS} Actual: {audit_logs}\")\n        else:\n            audit_logs[8] = audit_logs[8].format(date).replace(\"{\", \"\").replace(\"}\", \"\")\n            audit_logs[10] = audit_logs[10].format(date_time).replace(\"{\", \"\").replace(\"}\", \"\")\n            normalized_expected_logs = list(map(lambda log: \" \".join(log.split()), const.AUDIT_LOGS))\n            normalized_actual_logs = list(map(lambda log: \" \".join(log.split()), audit_logs))\n            sorted_actual_audit_logs = sorted(normalized_actual_logs)\n            sorted_expected_audit_logs = sorted(normalized_expected_logs)\n            if sorted_actual_audit_logs != sorted_expected_audit_logs:\n>               raise AssertionError(\n                    f\"Audit logs for parameters linked with cjf resource parameter are not as expected. \"\n                    f\"Expected: {sorted_expected_audit_logs} Actual: {sorted_actual_audit_logs}\")\nE               AssertionError: Audit logs for parameters linked with cjf resource parameter are not as expected. Expected: ['Malini L (ID:L-process.publisher.03) completed the Job', 'Malini L (ID:L-process.publisher.03) completed the task \"Task-1.1\" as Task1.1 of the stage \"Stage-1\"', 'Malini L (ID:L-process.publisher.03) created the Job', 'Malini L (ID:L-process.publisher.03) started the Job', 'Malini L (ID:L-process.publisher.03) started the task \"Task-1.1\" as Task1.1 of the stage \"Stage-1\"', 'System (ID:SYSTEM) Assigned User Group(s) to Task(s) in the Job', 'System (ID:SYSTEM) Assigned User(s) to Task(s) in the Job', 'System (ID:SYSTEM) Unassigned User Group(s) from Task(s) in the Job', 'System (ID:SYSTEM) provided a value of \"123\" for \"number-1\" in Task1.1 \"Task-1.1\" of the stage \"Stage-1\"', 'System (ID:SYSTEM) set \"Dec 01, 2023 13:23\" for \"date_time-1\" in Task1.1 \"Task-1.1\" of the stage \"Stage-1\"', 'System (ID:SYSTEM) set \"Dec 12, 2012\" for \"date-1\" in Task1.1 \"Task-1.1\" of the stage \"Stage-1\"', 'System (ID:SYSTEM) updated text input to \"multi_line\" for parameter \"multi_line_text-1\" in Task1.1 \"Task-1.1\" of the stage \"Stage-1\"', 'System (ID:SYSTEM) updated text input to \"single_line\" for parameter \"single_line_text-1\" in Task1.1 \"Task-1.1\" of the stage \"Stage-1\"'] Actual: ['Malini L (ID:L-process.publisher.03) completed the Job', 'Malini L (ID:L-process.publisher.03) completed the task \"Task-1.1\" as Task1.1 of the stage \"Stage-1\"', 'Malini L (ID:L-process.publisher.03) created the Job', 'Malini L (ID:L-process.publisher.03) selected \"Auto-test-object(ID: Auto_single_line_value_933817)\" for parameter \"single_resource-1\" for Create Job Form (CFJ) Parameter', 'Malini L (ID:L-process.publisher.03) started the Job', 'Malini L (ID:L-process.publisher.03) started the task \"Task-1.1\" as Task1.1 of the stage \"Stage-1\"', 'System (ID:SYSTEM) Assigned User Group(s) to Task(s) in the Job', 'System (ID:SYSTEM) Assigned User(s) to Task(s) in the Job', 'System (ID:SYSTEM) Unassigned User Group(s) from Task(s) in the Job', 'System (ID:SYSTEM) provided a value of \"123\" for \"number-1\" in Task1.1 \"Task-1.1\" of the stage \"Stage-1\"', 'System (ID:SYSTEM) set \"{{{0}}}\" for \"date-1\" in Task1.1 \"Task-1.1\" of the stage \"Stage-1\"', 'System (ID:SYSTEM) set \"{{{0}}}\" for \"date_time-1\" in Task1.1 \"Task-1.1\" of the stage \"Stage-1\"', 'System (ID:SYSTEM) updated text input to \"multi_line\" for parameter \"multi_line_text-1\" in Task1.1 \"Task-1.1\" of the stage \"Stage-1\"', 'System (ID:SYSTEM) updated text input to \"single_line\" for parameter \"single_line_text-1\" in Task1.1 \"Task-1.1\" of the stage \"Stage-1\"']\n\ntests/scenarios/job_audits/test_audit_logs_of_linked_parameters.py:152: AssertionError","flaky":false,"newFailed":false,"newBroken":false,"newPassed":false,"retriesCount":0,"retriesStatusChange":false,"beforeStages":[{"name":"env_setup","time":{"start":1733490527832,"stop":1733490527832,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"login_fixture","time":{"start":1733490527832,"stop":1733490528079,"duration":247},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"get_facility","time":{"start":1733490528079,"stop":1733490528284,"duration":205},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"select_usecase_fixture","time":{"start":1733490528284,"stop":1733490528542,"duration":258},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"username_to_user_id_mapping","time":{"start":1733490528542,"stop":1733490529001,"duration":459},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"user_group_creation","time":{"start":1733504897159,"stop":1733504897812,"duration":653},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"clear_audit_logs","time":{"start":1733504954782,"stop":1733504954782,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"flush_param_counters","time":{"start":1733504954782,"stop":1733504954782,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"afterStages":[{"name":"clear_audit_logs::0","time":{"start":1733504974379,"stop":1733504974379,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"flush_param_counters::0","time":{"start":1733504974379,"stop":1733504974380,"duration":1},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"labels":[{"name":"tag","value":"job_audits_for_linked_parameters_with_cjf_resource_parameter"},{"name":"tag","value":"job_audits"},{"name":"tag","value":"job"},{"name":"tag","value":"scenario"},{"name":"parentSuite","value":"tests.scenarios.job_audits"},{"name":"suite","value":"test_audit_logs_of_linked_parameters"},{"name":"subSuite","value":"TestAuditLogsOfLinkedParameters"},{"name":"host","value":"ubuntu"},{"name":"thread","value":"29333-MainThread"},{"name":"framework","value":"pytest"},{"name":"language","value":"cpython3"},{"name":"package","value":"tests.scenarios.job_audits.test_audit_logs_of_linked_parameters"},{"name":"resultFormat","value":"allure2"}],"parameters":[{"name":"job_execution_by","value":"'user_group'"},{"name":"users_list","value":"[]"}],"links":[{"name":"https://app.clickup.com/t/86cuvfapc","url":"https://app.clickup.com/t/86cuvfapc","type":"link"}],"hidden":true,"retry":true,"extra":{"categories":[],"tags":["job_audits_for_linked_parameters_with_cjf_resource_parameter","job_audits","scenario","job"]},"source":"6db3953bc8922451.json","parameterValues":["'user_group'","[]"]}